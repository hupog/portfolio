---
import "../styles/global.css";
import Navbar from "../components/Navbar.astro";
import Intro from "../components/Intro.astro";
import Projects from "../components/Projects.astro";
import Contact from "../components/Contact.astro";
import Experience from "../components/Experience.astro";
import es from "../i18n/es.json";
import en from "../i18n/en.json";

const urlLang = Astro.url.searchParams.get('lang');
let lang = urlLang || 'es';
const t = lang === 'en' ? en : es;
---

<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <title>.dev</title>
    <link rel="icon" type="image/png" href="/logo-head.png" />
  </head>
  <body
    class="animate-gradient bg-gradient-to-br from-blue-700 via-green-800 to-black"
  >
    <Navbar t={t} lang={lang} />
    <main>
      <Intro t={t} />
      <Projects t={t} />
      <Experience t={t} />
      <Contact t={t} />
    <script>
      const stored = localStorage.getItem("lang");
      if(stored && !window.location.search.includes("lang=")){
        const url = new URL(window.location.href);
        url.searchParams.set("lang", stored);
        window.location.replace(url);
      } else if(!stored){
        localStorage.setItem("lang", lang);
      }
    </script>
    </main>
  </body>
</html>
